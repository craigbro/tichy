<project default="package" basedir=".">

    <!--Initialization Target-->
    <target name="init">
        <tstamp/>
        <property name="Name" value="Alicebot Program D"/>
        <property name="name" value="aliceserver"/>
        <property name="version" value="4.1.5"/>
        <property name="year" value="2002"/>
        
        <echo message="Building ${Name} ${version}...."/>
        
        <property name="build.compiler" value="modern"/>
        <property name="debug" value="off"/>
        <property name="optimize" value="on"/>
        <property name="deprecation" value="on"/>
        
        <property name="src.dir" value="../src"/>
        <property name="lib.dir" value="../lib"/>
        <property name="packages" value="org.alicebot.*"/>
        
        <property name="build.dir" value="../classes"/>
        <property name="build.src" value="../src"/>
        <property name="build.dest" value="../classes"/>
        <property name="build.javadocs" value="../docs/api"/>
        
        <filter token="year" value="${year}"/>
        <filter token="version" value="${version}"/>
        <filter token="date" value="${TODAY}"/>
        <filter token="log" value="true"/>
        <filter token="verbose" value="true"/>
        
    </target>
    
    <!--Help on usage-->
    <target name="usage">
        <echo message=""/>
        <echo message=""/>
        <echo message="Alicebot Program D Build System"/>
        <echo message="-------------------------------------------------------------"/>
        <echo message=""/>
        <echo message=" Available targets are:"/>
        <echo message=""/>
        <echo message="   package  --> generates the server.jar file (default)"/>
        <echo message="   compile  --> compiles the source code"/>
        <echo message="   javadoc  --> generates the API documentation"/>
        <echo message="   clean    --> cleans up the directory"/>
        <echo message=""/>
        <echo message=" See the comments inside the build.xml file for more details."/>
        <echo message="-------------------------------------------------------------"/>
        <echo message=""/>
        <echo message=""/>
    </target>
    
    <!--Prepare the build directory.-->
    <target name="prepare" depends="init">
        <mkdir dir="${build.dir}"/>
    </target>
    
    <!--Prepare the source code.-->
    <target name="prepare-src" depends="prepare">
        
        <mkdir dir="${build.dest}"/>
        
        <!-- copy over properties and xml files -->
        <copy todir="${build.dest}">
            <fileset dir="${build.src}">
                <include name="**/*.properties"/>
                <include name="**/*.xml"/>
            </fileset>
        </copy>
    </target>
    
    <!--Compile the source directory.-->
    <target name="compile" depends="prepare-src">
        <javac srcdir="${build.src}"
            destdir="${build.dest}"
            debug="${debug}"
            deprecation="${deprecation}"
            optimize="${optimize}"/>
    </target>
    
    <!--Create the class package.-->
    <target name="package" depends="compile">
        <!--<fixcrlf srcdir="." includes="**/*.bat" cr="add"/>-->
        <!--<fixcrlf srcdir="." includes="**/*.sh" cr="remove"/>-->
        <jar jarfile="../lib/${name}.jar">
            <fileset dir="${build.dest}/" includes="org/**"/>
            <fileset dir="${build.src}/" includes="org/alicebot/icons/**"/>
        </jar>
    </target>
    
    <!--Create the API documentation.-->
    <target name="javadoc" depends="prepare-src">
        <mkdir dir="${build.javadocs}"/>
        <javadoc packagenames="${packages}"
            sourcepath="${build.src}"
            destdir="${build.javadocs}"
            author="true"
            version="true"
            use="false"
            splitindex="true"
            noindex="false"
            windowtitle="${Name} API"
            doctitle="${Name} API"
            bottom="Copyright &#169; ${year} A.L.I.C.E. AI Foundation. All Rights Reserved."
            />
    </target>
    
    <!--Clean target.-->
    <target name="clean" depends="init">
        <delete dir="${build.dir}"/>
    </target>
    
    <target name="distclean" depends="clean">
        <deltree dir="${dist.root}"/>
        <delete file="${Name}-${version}.tar.gz"/>
        <delete file="${Name}-${version}.tar"/>
        <delete file="${Name}-${version}.zip"/>
    </target>
    
</project>

